---
# tasks file for webserver

- name: upgrade all packages
  yum: 
    name: '*' 
    state: latest

- name: Installer resurcer
  yum:
    name: "{{ packages }}"
  vars:
    packages:
    - httpd
    - epel-release
    - vim
    - bind-utils

- name: inserting website index.html file
  ansible.builtin.template:
    src: index.html
    dest: /var/www/html/index.html
    owner: root
    group: wheel
    mode: 750
  become: yes
  notify: 
      - Make sure httpd unit is running


- name: firewalld rules
  ansible.posix.firewalld:
    service: "{{ item }}"
    state: enabled
    permanent: true
    immediate: true
  with_items:
    - http
    - ssh
  notify:
      - Make sure firewalld unit is running


#- name: permit traffic in default zone on all relevant ports. Then enable firewalld.
#  ansible.posix.firewalld:
#    port: "{{  item  }}"
#    permanent: yes
#    state: enabled
#  loop:
#      - "80/tcp"
#      - "22/tcp"
#  notify: 
#      - Make sure firewalld unit is running